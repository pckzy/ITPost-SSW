{% extends "board_base.html" %}

{% load static %}

{% block head %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<div class="bg-white rounded-2xl shadow-lg overflow-hidden mb-6">
    <div class="bg-gradient-to-b from-[#011A4F] to-[#023BB5] text-white p-8">
        <h1 class="text-3xl font-bold mb-2">ตั้งค่าข้อมูลโปรไฟล์</h1>
        <p class="opacity-90">กรอกข้อมูลเพื่อแก้ไขโปรไฟล์</p>
    </div>
    
    <form action="" method="post" class="p-4 mb-3 mx-6" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-6">
            <div class="">
                <label for="{{ user_form.first_name.id_for_label }}"
                class="block mb-2 text-lg font-medium text-gray-900">ชื่อจริง 
                <span class="text-red-600">*</span></label>
                {{ user_form.first_name }}
            </div>
            <div class="">
                <label for="{{ user_form.last_name.id_for_label }}"
                class="block mb-2 text-lg font-medium text-gray-900">นามสกุล 
                <span class="text-red-600">*</span></label>
                {{ user_form.last_name }}
            </div>
            <div class="">
                <label for="{{ user_form.username.id_for_label }}"
                class="block mb-2 text-lg font-medium text-gray-900">ชื่อผู้ใช้ 
                <span class="text-red-600">*</span></label>
                {{ user_form.username }}
            </div>
            <div class="">
                <label for="{{ user_form.password.id_for_label }}"
                class="block mb-2 text-lg font-medium text-gray-900">รหัสผ่าน 
                <span class="text-red-600">*</span></label>
                {{ user_form.password }}
            </div>
            <div class="">
                <label for="{{ user_form.email.id_for_label }}"
                class="block mb-2 text-lg font-medium text-gray-900">อีเมล 
                <span class="text-red-600">*</span></label>
                {{ user_form.email }}
            </div>
            <div class="{% if user_logged.role.id == 2 %}hidden{% endif %}">
                <label for="{{ user_form.role.id_for_label }}"
                class="block mb-2 text-lg font-medium text-gray-900">บทบาท 
                <span class="text-red-600">*</span></label>
                {{ user_form.role }}
            </div>
        </div>
        
        <div class="mt-3">
            <div class="flex gap-4">
                <div class="flex flex-col flex-1 gap-4 justify-end">
                    <label for="{{ user_form.role.id_for_label }}"
                    class="block mb-2 text-lg font-medium text-gray-900">รูปโปรไฟล์
                    {{ user_form.image }}
                </div>
                <div class="w-24 h-24 rounded-lg overflow-hidden border border-gray-300">
                    <img id="preview" src="/media/{{ user.image }}" alt="Profile preview" class="w-full h-full object-cover">
                </div>
            </div>
        </div>

        <div class="flex space-x-4 mt-6">
            <a href="{% url 'profile_view' user_logged.username %}" class="flex-1 bg-gray-500 text-white py-3 px-6 rounded-lg hover:bg-gray-600 transition font-semibold text-center">
                ยกเลิก
            </a>
            <button type="submit" class="flex-1 bg-blue-500 text-white py-3 px-6 rounded-lg hover:bg-blue-600 transition font-semibold">
                <i class="fa fa-square-check"></i> แก้ไขโปรไฟล์
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block script %}
<script>
  const imageId = "{{ user_form.image.id_for_label }}"
  const srcImg = "{{ user.image }}"
</script>
<script src="{% static 'js/special_edit.js' %}"></script>
{% endblock %}